<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>إتمام الطلب - Slyvie in bloom</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --brand-primary: #8b2623;
        --brand-cream: #fdfcf3;
        --brand-dark: #6b1e1b;
        --brand-light: #a5312e;
        --brand-accent: rgba(139, 38, 35, 0.1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Noto Sans Arabic", "Inter", sans-serif;
        background-color: var(--brand-cream);
        color: var(--brand-primary);
        line-height: 1.6;
        direction: rtl;
      }

      .font-serif {
        font-family: "Playfair Display", serif;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 16px;
      }

      /* Header Styles */
      .header {
        position: sticky;
        top: 0;
        background: rgba(253, 252, 243, 0.95);
        backdrop-filter: blur(8px);
        border-bottom: 1px solid var(--brand-accent);
        z-index: 50;
      }

      .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 64px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        color: var(--brand-primary);
      }

      .logo img {
        width: 32px;
        height: 32px;
        object-fit: contain;
      }

      .logo-text {
        font-size: 20px;
        font-weight: 600;
        font-family: "Playfair Display", serif;
      }

      .nav {
        display: flex;
        gap: 32px;
      }

      .nav a {
        color: var(--brand-primary);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s;
      }

      .nav a:hover {
        color: var(--brand-dark);
      }

      .btn {
        padding: 8px 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
      }

      .btn-primary {
        background: var(--brand-primary);
        color: var(--brand-cream);
      }

      .btn-primary:hover {
        background: var(--brand-dark);
      }

      .btn-outline {
        background: transparent;
        color: var(--brand-primary);
        border: 1px solid var(--brand-primary);
      }

      .btn-outline:hover {
        background: var(--brand-primary);
        color: var(--brand-cream);
      }

      /* Form Styles */
      .form-section {
        padding: 80px 0;
        min-height: 70vh;
      }

      .form-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        padding: 48px;
        box-shadow: 0 8px 32px rgba(139, 38, 35, 0.1);
        border: 1px solid var(--brand-accent);
      }

      .form-header {
        text-align: center;
        margin-bottom: 48px;
      }

      .form-header h1 {
        font-size: 2.5rem;
        font-family: "Playfair Display", serif;
        margin-bottom: 16px;
        color: var(--brand-primary);
      }

      .form-header p {
        font-size: 18px;
        color: rgba(139, 38, 35, 0.7);
      }

      .form-grid {
        display: grid;
        gap: 24px;
        margin-bottom: 32px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .form-label {
        font-weight: 600;
        color: var(--brand-primary);
        font-size: 16px;
      }

      .form-input {
        padding: 16px;
        border: 2px solid var(--brand-accent);
        border-radius: 8px;
        font-size: 16px;
        font-family: inherit;
        transition: all 0.3s;
        background: var(--brand-cream);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--brand-primary);
        box-shadow: 0 0 0 3px rgba(139, 38, 35, 0.1);
      }

      .form-input::placeholder {
        color: rgba(139, 38, 35, 0.5);
      }

      .select-input {
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23655d5d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: left 12px center;
        background-size: 20px;
        padding-left: 44px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
      }

      .order-summary {
        background: var(--brand-accent);
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 32px;
      }

      .order-summary h3 {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 16px;
        color: var(--brand-primary);
      }

      .order-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid rgba(139, 38, 35, 0.1);
      }

      .order-item:last-child {
        border-bottom: none;
        font-weight: 600;
        font-size: 18px;
        margin-top: 8px;
        padding-top: 16px;
        border-top: 2px solid var(--brand-primary);
      }

      .form-actions {
        display: flex;
        gap: 16px;
        justify-content: center;
      }

      .form-actions .btn {
        padding: 16px 32px;
        font-size: 16px;
        min-width: 150px;
      }

      .breadcrumb {
        background: var(--brand-accent);
        padding: 16px 0;
        margin-bottom: 0;
      }

      .breadcrumb-list {
        display: flex;
        align-items: center;
        gap: 8px;
        list-style: none;
      }

      .breadcrumb-item {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .breadcrumb-item a {
        color: var(--brand-primary);
        text-decoration: none;
        transition: color 0.3s;
      }

      .breadcrumb-item a:hover {
        color: var(--brand-dark);
      }

      .breadcrumb-separator {
        color: rgba(139, 38, 35, 0.5);
      }

      /* Footer */
      .footer {
        background: var(--brand-primary);
        color: var(--brand-cream);
        padding: 64px 0 24px;
      }

      .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 48px;
        margin-bottom: 48px;
      }

      .footer-brand {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 16px;
      }

      .footer-brand img {
        width: 32px;
        height: 32px;
        filter: brightness(0) invert(1);
      }

      .footer-brand-text {
        font-size: 20px;
        font-weight: 600;
        font-family: "Playfair Display", serif;
      }

      .footer-description {
        opacity: 0.8;
        margin-bottom: 24px;
        line-height: 1.6;
      }

      .footer-section h3 {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 16px;
      }

      .footer-links {
        list-style: none;
      }

      .footer-links li {
        margin-bottom: 8px;
      }

      .footer-links a {
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: color 0.3s;
      }

      .footer-links a:hover {
        color: white;
      }

      .footer-bottom {
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        padding-top: 24px;
        text-align: center;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .nav {
          display: none;
        }

        .form-container {
          padding: 32px 24px;
          margin: 16px;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .form-actions {
          flex-direction: column;
        }

        .footer-content {
          grid-template-columns: 1fr;
          gap: 32px;
          text-align: center;
        }
      }

      /* Success message */
      .success-message {
        background: #22c55e;
        color: white;
        padding: 16px;
        border-radius: 8px;
        margin-bottom: 24px;
        display: none;
      }

      .error-message {
        background: #ef4444;
        color: white;
        padding: 16px;
        border-radius: 8px;
        margin-bottom: 24px;
        display: none;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <!-- Logo -->
          <a href="index.html" class="logo">
            <img
              src="https://cdn.builder.io/api/v1/image/assets%2F13e11346f6ee4de6b150f7304f4e7aca%2Fd6d5745669d541e0b6da8b0f22033c5a?format=webp&width=800"
              alt="Slyvie in bloom logo"
            />
            <span class="logo-text">Slyvie in bloom</span>
          </a>

          <!-- Navigation -->
          <nav class="nav">
            <a href="index.html">الرئيسية</a>
            <a href="index.html#shop">المتجر</a>
            <a href="#about">من نحن</a>
            <a href="#contact">تواصل معنا</a>
          </nav>
        </div>
      </div>
    </header>

    <!-- Breadcrumb -->
    <section class="breadcrumb">
      <div class="container">
        <ul class="breadcrumb-list">
          <li class="breadcrumb-item">
            <a href="index.html">الرئيسية</a>
          </li>
          <li class="breadcrumb-separator">←</li>
          <li class="breadcrumb-item">
            <span>إتمام الطلب</span>
          </li>
        </ul>
      </div>
    </section>

    <!-- Order Form -->
    <section class="form-section">
      <div class="container">
        <div class="form-container">
          <div class="form-header">
            <h1 class="font-serif">إتمام الطلب</h1>
            <p>يرجى تعبئة البيانات التالية لإتمام طلبك</p>
          </div>

          <div class="success-message" id="successMessage">
            تم إرسال طلبك بنجاح! سنتواصل معك قريباً لتأكيد الطلب.
          </div>

          <div class="error-message" id="errorMessage">
            يرجى تعبئة جميع الحقول المطلوبة.
          </div>

          <!-- Order Summary -->
          <div class="order-summary">
            <h3>ملخص الطلب</h3>
            <div id="orderItems">
              <!-- Items will be populated by JavaScript -->
            </div>
          </div>

          <form id="orderForm">
            <div class="form-grid">
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label" for="firstName"
                    >الاسم الأول *</label
                  >
                  <input
                    type="text"
                    id="firstName"
                    name="firstName"
                    class="form-input"
                    placeholder="أدخل الاسم الأول"
                    required
                  />
                </div>
                <div class="form-group">
                  <label class="form-label" for="lastName">اسم العائلة *</label>
                  <input
                    type="text"
                    id="lastName"
                    name="lastName"
                    class="form-input"
                    placeholder="أدخل اسم العائلة"
                    required
                  />
                </div>
              </div>

              <div class="form-group">
                <label class="form-label" for="phone">رقم الجوال *</label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  class="form-input"
                  placeholder="05xxxxxxxx"
                  pattern="[0-9]{10}"
                  required
                />
              </div>

              <div class="form-group">
                <label class="form-label" for="email">البريد الإلكتروني</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="form-input"
                  placeholder="example@email.com"
                />
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label class="form-label" for="city">المدينة *</label>
                  <select
                    id="city"
                    name="city"
                    class="form-input select-input"
                    required
                  >
                    <option value="">اختر المدينة</option>
                    <option value="riyadh">الرياض</option>
                    <option value="jeddah">جدة</option>
                    <option value="dammam">الدمام</option>
                    <option value="mecca">مكة المكرمة</option>
                    <option value="medina">المدينة المنورة</option>
                    <option value="taif">الطائف</option>
                    <option value="tabuk">تبوك</option>
                    <option value="buraidah">بريدة</option>
                    <option value="khobar">الخبر</option>
                    <option value="hail">حائل</option>
                    <option value="abha">أبها</option>
                    <option value="jazan">جازان</option>
                    <option value="najran">نجران</option>
                    <option value="other">أخرى</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="form-label" for="district">الحي *</label>
                  <input
                    type="text"
                    id="district"
                    name="district"
                    class="form-input"
                    placeholder="أدخل اسم الحي"
                    required
                  />
                </div>
              </div>

              <div class="form-group">
                <label class="form-label" for="address"
                  >العنوان التفصيلي *</label
                >
                <textarea
                  id="address"
                  name="address"
                  class="form-input"
                  rows="3"
                  placeholder="الشارع، رقم المبنى، تفاصيل إضافية..."
                  required
                ></textarea>
              </div>

              <div class="form-group">
                <label class="form-label" for="notes">ملاحظات إضافية</label>
                <textarea
                  id="notes"
                  name="notes"
                  class="form-input"
                  rows="3"
                  placeholder="أي ملاحظات أ�� طلبات خاصة..."
                ></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn btn-outline" onclick="goBack()">
                العودة للسلة
              </button>
              <button type="submit" class="btn btn-primary">إتمام الطلب</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <!-- Brand -->
          <div>
            <div class="footer-brand">
              <img
                src="https://cdn.builder.io/api/v1/image/assets%2F13e11346f6ee4de6b150f7304f4e7aca%2Fd6d5745669d541e0b6da8b0f22033c5a?format=webp&width=800"
                alt="Logo"
              />
              <span class="footer-brand-text">Slyvie in bloom</span>
            </div>
            <p class="footer-description">
              قطع كروشيه مصنوعة يدوياً بحب واهتمام. كل قطعة فريدة ومصممة لتضفي
              الدفء على منزلك.
            </p>
          </div>

          <!-- Quick Links -->
          <div class="footer-section">
            <h3>روابط سريعة</h3>
            <ul class="footer-links">
              <li><a href="index.html">الرئيسية</a></li>
              <li><a href="index.html#shop">المتجر</a></li>
              <li><a href="policies.html">سياسات المتجر</a></li>
              <li><a href="#contact">تواصل معنا</a></li>
            </ul>
          </div>

          <!-- Categories -->
          <div class="footer-section">
            <h3>الفئات</h3>
            <ul class="footer-links">
              <li><a href="#">منتجات الأطفال</a></li>
              <li><a href="#">ديكور المنزل</a></li>
              <li><a href="#">اكسسوارات</a></li>
              <li><a href="#">ألعاب</a></li>
            </ul>
          </div>

          <!-- Contact -->
          <div class="footer-section">
            <h3>معلومات التواصل</h3>
            <ul class="footer-links">
              <li>Slyvieinbloom@gmail.com</li>
              <li>+966 50 123 4567</li>
              <li>الرياض، المملكة العربية السعودية</li>
            </ul>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; ٢٠٢٤ Slyvie in bloom. جميع الحقوق محفوظة.</p>
        </div>
      </div>
    </footer>

    <script>
      // Load cart data and display order summary
      function loadOrderSummary() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const orderItemsContainer = document.getElementById("orderItems");

        if (cart.length === 0) {
          orderItemsContainer.innerHTML = `
                    <div class="order-item">
                        <span>السلة فارغة</span>
                        <span><a href="index.html" style="color: var(--brand-primary);">العودة للتسوق</a></span>
                    </div>
                `;
          return;
        }

        let total = 0;
        let itemsHTML = "";

        cart.forEach((item) => {
          const itemTotal = item.price * item.quantity;
          total += itemTotal;
          itemsHTML += `
                    <div class="order-item">
                        <span>${item.name} (${item.quantity})</span>
                        <span>${itemTotal} ريال</span>
                    </div>
                `;
        });

        itemsHTML += `
                <div class="order-item">
                    <span>الشحن</span>
                    <span>مجاني</span>
                </div>
                <div class="order-item">
                    <span>المجموع الكلي</span>
                    <span>${total} ريال</span>
                </div>
            `;

        orderItemsContainer.innerHTML = itemsHTML;
      }

      // Form submission
      document
        .getElementById("orderForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(this);
          const orderData = Object.fromEntries(formData);
          const cart = JSON.parse(localStorage.getItem("cart")) || [];

          // Validate required fields
          const requiredFields = [
            "firstName",
            "lastName",
            "phone",
            "city",
            "district",
            "address",
          ];
          let isValid = true;

          requiredFields.forEach((field) => {
            if (!orderData[field] || orderData[field].trim() === "") {
              isValid = false;
            }
          });

          if (!isValid) {
            document.getElementById("errorMessage").style.display = "block";
            document.getElementById("successMessage").style.display = "none";
            return;
          }

          // Create formatted order data
          const orderNumber = "SB" + Date.now().toString().slice(-6);
          const orderDate = new Date().toLocaleDateString("ar-SA");
          const total = cart.reduce(
            (sum, item) => sum + item.price * item.quantity,
            0,
          );

          // Format order data for WhatsApp
          let orderMessage = `🧶 *طلب جديد من متجر سليفي إن بلوم* 🌸\n\n`;
          orderMessage += `📋 *رقم الطلب:* ${orderNumber}\n`;
          orderMessage += `📅 *التاريخ:* ${orderDate}\n\n`;
          orderMessage += `👤 *بيانات العميل:*\n`;
          orderMessage += `• الاسم: ${orderData.firstName} ${orderData.lastName}\n`;
          orderMessage += `• الجوال: ${orderData.phone}\n`;
          orderMessage += `• البريد: ${orderData.email || "غير محدد"}\n`;
          orderMessage += `• المدينة: ${orderData.city}\n`;
          orderMessage += `• الحي: ${orderData.district}\n`;
          orderMessage += `• العنوان: ${orderData.address}\n\n`;

          orderMessage += `🛍️ *تفاصيل الطلب:*\n`;
          cart.forEach((item, index) => {
            orderMessage += `${index + 1}. ${item.name}\n`;
            orderMessage += `   - الكمية: ${item.quantity}\n`;
            orderMessage += `   - السعر: ${item.price} ريال\n`;
            orderMessage += `   - المجموع: ${item.price * item.quantity} ريال\n\n`;
          });

          orderMessage += `💰 *المجموع الكلي: ${total} ريال*\n\n`;

          if (orderData.notes) {
            orderMessage += `📝 *ملاحظات:* ${orderData.notes}\n\n`;
          }

          orderMessage += `✨ شكراً لثقتك في متجر سليفي إن بلوم!`;

          // Store order data for reference
          const orderRecord = {
            orderNumber,
            date: orderDate,
            customer: orderData,
            items: cart,
            total: total,
            status: "pending",
          };

          // Save to localStorage for backup
          let orders = JSON.parse(localStorage.getItem("orders") || "[]");
          orders.push(orderRecord);
          localStorage.setItem("orders", JSON.stringify(orders));

          console.log("Order Data:", orderRecord);
          console.log("WhatsApp Message:", orderMessage);

          // Show success message with order number
          document.getElementById("errorMessage").style.display = "none";
          const successMsg = document.getElementById("successMessage");
          successMsg.innerHTML = `تم إرسال طلبك بنجاح!<br>رقم الطلب: <strong>${orderNumber}</strong><br>سنتواصل معك قريباً لتأكيد الطلب.`;
          successMsg.style.display = "block";

          // Auto-send to WhatsApp
          const phoneNumber = "966501234567";
          const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(orderMessage)}`;

          // Clear cart after successful order
          localStorage.removeItem("cart");

          // Redirect to payment page after showing success message
          setTimeout(() => {
            window.open(whatsappUrl, "_blank");
            window.location.href = "payment.html";
          }, 3000);
        });

      function goBack() {
        window.history.back();
      }

      // Phone number formatting
      document.getElementById("phone").addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");
        if (value.length > 10) {
          value = value.slice(0, 10);
        }
        e.target.value = value;
      });

      // Load order summary on page load
      loadOrderSummary();
    </script>
  </body>
</html>
